import{j as o,a as e,S,r as h,F as k}from"./index.6e2ee43a.js";const y="/assets/warning.cf7899ad.svg",C=({loading:t,submit:r,value:c,setValue:i})=>o("form",{className:"card",onSubmit:r,children:[e("label",{children:"Enter the number of Seats"}),e("input",{type:"number","data-error":c>=1&&c<=7?void 0:"true",value:c,disabled:t,onChange:d=>{i(d.target.value)}}),c>=1&&c<=7?"":o("div",{className:"error-warn",children:[e("img",{src:y,alt:"input error"}),e("span",{children:"Enter A valid number between 1 and 7"})]}),e("button",{disabled:!(c>=1&&c<=7&&!t),className:"submit-btn",type:"submit",children:t?e("img",{src:S,className:"spinner",alt:"loading"}):e("span",{children:"Reserve Ticket"})})]}),x={filled:"red",empty:"blue",current:"green"},w=({status:t,seatNo:r})=>o("div",{className:"seat",children:[e("span",{children:r}),e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:"24px",width:"24px",fill:x[t],children:e("path",{d:"M368 448h-49.88l-14.27-114.1C302.9 325.9 296.1 320 288 320H144C135.2 320 128 312.8 128 304V224h128c8.838 0 16-7.164 16-16C272 199.2 264.8 192 256 192H128V160c0-8.844-7.156-16-16-16S96 151.2 96 160v144C96 330.5 117.5 352 144 352h129.1l14.13 114C289.1 474 295.9 480 304 480h64c8.844 0 16-7.156 16-16S376.8 448 368 448zM208 416H131.2C76.5 416 32 371.5 32 316.8V144C32 135.2 24.84 128 16 128S0 135.2 0 144v172.8C0 389.2 58.86 448 131.2 448H208c8.844 0 16-7.156 16-16S216.8 416 208 416zM136 112C166.9 112 192 86.93 192 56S166.9 0 136 0S80 25.07 80 56S105.1 112 136 112zM136 32C149.2 32 160 42.77 160 56C160 69.23 149.2 80 136 80S112 69.23 112 56C112 42.77 122.8 32 136 32z"})})]}),v=["filled","empty","current"],j=({list:t,uid:r})=>{const[c,i]=h.exports.useState([]);h.exports.useEffect(()=>{let n=[];for(let s=0;s<t.length;s++)for(let l=0;l<t[s].length;l++)t[s][l].booked&&t[s][l].userId===r&&n.push(t[s][l].row+t[s][l].seatId);i(n)},[t,r]);function d(){let n=[];for(let s=0;s<t.length;s++){let l=[];for(let a=0;a<t[s].length;a++)t[s][a].booked&&t[s][a].userId===r?l.push(e(w,{status:v[2],seatNo:t[s][a].row+t[s][a].seatId},`${s}${a}`)):t[s][a].booked&&t[s][a].userId!==r?l.push(e(w,{status:v[0],seatNo:t[s][a].row+t[s][a].seatId},`${s}${a}`)):l.push(e(w,{status:v[1],seatNo:t[s][a].row+t[s][a].seatId},`${s}${a}`));s===0?n.push(e("div",{className:"row middle",children:l},`${s}8`)):n.push(e("div",{className:"row evenly",children:l},`${s}8`))}return e("div",{className:"col",children:n})}return o("div",{className:"card",children:[o("div",{className:"col",children:[o("div",{className:"row",children:[e("div",{className:"box",style:{backgroundColor:"red"}}),e("span",{children:"Booked by someone Else"})]}),o("div",{className:"row",children:[e("div",{className:"box",style:{backgroundColor:"green"}}),e("span",{children:"Your Current Seats"})]}),o("div",{className:"row",children:[e("div",{className:"box",style:{backgroundColor:"blue"}}),e("span",{children:"Empty Seats"})]})]}),o("div",{className:"col middle",children:[e("span",{children:"Your Seats Are :"}),e("div",{className:"row middle",children:c.map(n=>e("div",{className:"row",style:{padding:"0.5rem",color:"green"},children:n},n))})]}),d()]})};function B(){const[t,r]=h.exports.useState(!1),[c,i]=h.exports.useState([[]]),[d,n]=h.exports.useState(!1),[s,l]=h.exports.useState(1),[a,b]=h.exports.useState("");return o(k,{children:[d?e("div",{className:"fixed",children:o("nav",{className:"row middle",style:{margin:"20px"},children:[e("button",{style:{margin:"0.5rem"},onClick:()=>{i([[]]),n(!1),b("")},children:"Book More Tickets"}),e("button",{style:{margin:"0.5rem"},onClick:async()=>{r(!0);try{let m=await fetch("/api/clear");if(m.status===200)r(!1),alert("cleared successfully"),window.location.reload();else{r(!1);let g=await m.json();alert(g.message)}}catch(f){r(!1),alert(f.message)}},children:t?e("img",{src:S,className:"spinner",alt:"loading.."}):e("span",{children:"Clear All Bookings"})})]})}):"",o("div",{className:"App",children:[e("h1",{children:d?"Your Ticket":"Book Tickets"}),d?e(j,{list:c,uid:a}):e(C,{loading:t,value:s,setValue:l,setLoading:r,submit:async f=>{var m,g;f.preventDefault(),r(!0);try{const p=await fetch("/api/book",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({value:Number.parseInt(s)})});if(p.status===201){const u=await p.json();i(u.seats),n(!0),b(u.id)}else if(p.status===403){const u=await p.json();i(u.seats),n(!0),b(u.id),alert("not enough empty seats")}else{const u=await p.json();alert((m=u.message)!=null?m:"there was an error"),n(!1)}r(!1)}catch(N){n(!1),r(!1),alert((g=N.message)!=null?g:"there was an error")}}})]})]})}export{B as default};
